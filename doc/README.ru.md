# ReeePlayer

Приложение ReeePlayer предназначено для интервального повторения фрагментов (клипов) видео- и аудиофайлов по схожему принципу, что и в Anki-карточках.

## Основы

В самом начале для удобства рекомендуется создать или выбрать каталог на диске в котором будут располагаться те медиафайлы, которые планируются использовать для интервального повторения. 

Этот каталог нужно открыть с помощью (`Open Directory`) или перетащить мышкой из проводника в окно приложения.

Открытый каталог будет выглядеть примерно так как на рисунке (в начале количество клипов будет равно нулю).

![](./main_window.png?raw=true)

Для просмотра нужно дважды кликнуть по желаемому файлу.

![](./watching.png?raw=true)

Когда будет просмотрен некоторый фрагмент, который хотелось бы повторить в дальнейшем, нужно нажать `Add Clip` или нажать `Enter`.

![](./adding_clip.png?raw=true)

При необходимости создаваемый клип может быть отредактирован. Для сохранения клипа и продолжения просмотра нужно нажать `Save Clip` или `Enter`. Подробное описание способов редактирования будет приведено далее.

Для повторения добаленных клипов необходимо нажать `Repeat Clips` в главном меню, либо выбрать необходимые файлы и подкаталоги и выбрать `Repeat Selected` в контекстном меню.

В верхнем левом углу открывшегося окна показано оставшееся количество клипов, которые нужно повторить.

![](./repeating.png?raw=true)

Когда счетчик достигнет нуля, можно все равно продолжать повторение. В этом случае будут предлагаться наиболее подходящие клипы, у которых приближается время повторения. Для них интервал следующего повторения увеличится в зависимости от времени, прошедшего с предыдущего повторения.

## Подробности

### Просмотр

При запуске просмотра видеофайла с именем вида `x.<ext>` приложение осуществляет поиск файлов субтитров с именем вида `x<lang>.<srt или vtt>` в том же каталоге. Доступные субтитры можно выбрать из выпадающего списка ![](./subs_cmb.png?raw=true) в обоих панелях. 

Поле ввода ![](./sync_subs.png?raw=true) предназначено для синхронизации субтитров с видео с помощью стрелок или колесика мышки.

Кнопка ![](./show_always.png?raw=true) управляет видимостью субтитров (всегда показывать или скрывать), а ![](./show_once.png?raw=true) – видимостью только текущего текста.

В режиме  просмотра доступны горячие клавиши:

- `Space` – воспроизведение/пауза

- `Left`, `Right` – перемотка назад или вперед на 2 секунды

- `5`, `6`, `7`, `8`, `9`, `0` – скорость воспроизведения: 0.5, 0.6, 0.7, 0.8, 0.9, 1.0 от нормальной

- `1`, `2` – показать текущий текст первых/вторых субтитров если он скрыт

- `Enter` – добавить клип

### Добавление клипа

 Начало и конец создаваемого клипа, определяются по текущим субтитрам.
 
 ![](./clip_ab.png?raw=true)
 
 При необходимости можно изменить их с помощью:

- Стрелок на панели инструментов
- Прокрутки колесика мыши при наведении на соответствующее поле ввода
- Клавишами `Ctrl+Left`, `Ctrl+Right`, `Alt+Left`, `Alt+Left`. 

Последний способ является наиболее предпочтительным.

Если необходимо дополнить текст клипа предыдущим или следующим текстом из субтитров, то это можно осуществить кнопками ![](./insert_cue.png?raw=true).

В режиме  просмотра доступны следующие клавиши:

- `Space` – воспроизвести клип
- `5`, `6`, `7`, `8`, `9`, `0` – скорость воспроизведения: 0.5, 0.6, 0.7, 0.8, 0.9, 1.0 от нормальной
- `Enter`, `Ctrl+Enter` – сохранить клип
- `Delete` – отменить создание клипа

### Повторение

В этом режиме доступно редактирование клипа (начало, конец, тексты) таким же способом, что и при создании.

Горячие клавиши:

- `Space` – воспроизвести клип
- `5`, `6`, `7`, `8`, `9`, `0` – скорость воспроизведения: 0.5, 0.6, 0.7, 0.8, 0.9, 1.0 от нормальной
- `Enter` – отметить клип повторенным и перейти к следующему
- `Backspace` – вернуться к предыдущим повторенным клипам

### Где хранятся клипы

Все клипы файла с именем вида `x.<ext>` хранятся в файле `x.user.json` в той же директории. Например:

![](./files_example.png?raw=true)

Такой подход хранения позволяет изменять файловую иерархию по своему усмотрению, а имеено перемещать, переименовывать, объединять каталоги. Самое главное – хранить файл с клипами рядом с медиафайлом и перемещать их только вместе.

В качестве формата файла используется [JSON](https://ru.wikipedia.org/wiki/JSON), что позволяет просматривать и редактировать его в любом текстовом редакторе:

![](./json_example.png?raw=true)

## Сборка

Для сборки необходимо использовать компилятор с поддержкой C++17. На данный момент тестирование производилось только для MSVC 2019.

### Windows

- Установить [Qt 6](https://www.qt.io/). Добавить в переменную среды `PATH` каталог `%QTDIR%/bin`
- Скачать медиаплейер [VLC 3.0.8](http://download.videolan.org/pub/videolan/vlc/3.0.8/). Добавить в переменную среды `PATH` каталог с распакованным архивом, либо скопировать директорию `plugins` и библиотеки `libvlc.dll`, `libvlccore.dll` в каталог сборки.
- Установить cmake версии не ниже 3.16.0

Выполнить из каталога с проектом:

```
mkdir "../ReeePlayer_build"
cd "../ReeePlayer_build"
cmake --build . --config Release
```

## Прочее

- Иконки с сайта [Icons8.com](http://Icons8.com)
- Кадры, показанные в этом руководстве, из видео с канала [OverSimplified](https://www.youtube.com/c/OverSimplified/videos)
